{"version":3,"sources":["file:///Users/songxiangying/Desktop/cc1234223/assets/editor/UiEdColumn.ts"],"names":["_decorator","Component","Node","UITransform","v3","CwgPools","Glass","ccclass","menu","property","UiEdColumn","tooltip","createGlass","glass","glassPools","getGlass","init","position","x","y","colors","hideCnt","ad","colorCnt","undefined","glassNode","node","parent","glassesNode","active","moveDown","children","forEach","verticalStep","moveUp","reset","stageConfigs","adjustGlassCount","length","i","info","getComponent","targetCount","recycleGlass","height","bottom_y","index"],"mappings":"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","sourcesContent":["/**\n * @Descripttion: 控制瓶子数量和移动瓶子位置\n * @version: 1.0\n * @Author: Lioesquieu\n * @Date: 2025-07-20\n * @LastEditors: Lioesquieu\n * @LastEditTime: 2024-08-08\n */\nimport {_decorator, Component, Node, UITransform, v3} from 'cc';\nimport {CwgPools} from '../core/CwgPools';\nimport Glass from '../core/Glass';\nimport EdGlass from './EdGlass';\nimport {GlassInfo} from '../core/FunlandInfo';\n\nconst {ccclass, menu, property} = _decorator;\n\n@ccclass('UiEdColumn')\n@menu('cwg/UiEdColumn')\nexport default class UiEdColumn extends Component {\n\n    /** UI变换组件，用于控制容器尺寸和位置 */\n    @property(UITransform)\n    public uiTransform: UITransform;\n\n    /** 玻璃瓶容器节点，用于存放所有玻璃瓶实例 */\n    @property(Node)\n    public glassesNode: Node;\n\n    /** 对象池管理器，用于玻璃瓶的创建和回收 */\n    @property(CwgPools)\n    protected glassPools: CwgPools;\n\n    /** 垂直移动步长（单位：像素） */\n    @property({tooltip: \"垂直移动步长\"})\n    protected verticalStep: number = 20;\n\n    /** 创建单个玻璃瓶并加入场景 */\n    protected createGlass() {\n        // 从对象池获取可编辑玻璃瓶实例\n        const glass: EdGlass = this.glassPools.getGlass() as EdGlass;\n        // 初始化玻璃瓶参数（位置、颜色等）\n        glass.init({position: {x: 0, y: 0}, colors: [], hideCnt: 0, ad: false, colorCnt: undefined});\n\n        // 设置玻璃瓶位置并激活\n        const glassNode = glass.node;\n        glassNode.position = v3(0, 0, 0);\n        glassNode.parent = this.glassesNode;\n        glassNode.active = true;\n    }\n\n    /** 下移所有玻璃瓶 */\n    public moveDown() {\n        this.glassesNode.children.forEach((node) => {\n            node.y -= this.verticalStep;\n        })\n    }\n\n    /** 上移所有玻璃瓶 */\n    public moveUp() {\n        this.glassesNode.children.forEach((node) => {\n            node.y += this.verticalStep;\n        })\n    }\n\n    /** \n     * 根据关卡配置重置玻璃瓶\n     * @param stageConfigs 关卡配置数组，包含每个玻璃瓶的位置和状态\n     */\n    public reset(stageConfigs: GlassInfo[]) {\n        // 调整玻璃瓶数量匹配关卡配置\n        this.adjustGlassCount(stageConfigs.length);\n        // 设置每个玻璃瓶的初始位置和状态\n        for (let i = 0; i < stageConfigs.length; i++) {\n            const info = stageConfigs[i];\n            const node = this.glassesNode.children[i];\n            node.y = info.position.y;\n            const glass = node.getComponent(Glass);\n            glass && glass.init(info);\n        }\n    }\n\n    /**\n     * 调整玻璃瓶数量\n     * @param targetCount 目标数量\n     */\n    public adjustGlassCount(targetCount: number) {\n        // 补充缺少的玻璃瓶\n        for (let i = this.glassesNode.children.length; i < targetCount; i++) {\n            // 从对象池获取玻璃瓶实例\n            this.createGlass();\n        }\n        // 回收多余的玻璃瓶\n        for (let i = this.glassesNode.children.length - 1; i >= targetCount; i--) {\n            const node = this.glassesNode.children[i];\n            const glass = node.getComponent(Glass);\n            glass && this.glassPools.recycleGlass(glass);\n        }\n        // 重新排列所有玻璃瓶位置\n        if (targetCount > 0) {\n            const height = this.glassesNode.children[0].getComponent(UITransform).height;\n            const bottom_y = -targetCount * height / 2;\n            this.glassesNode.children.forEach((node, index) => {\n                node.y = bottom_y + index * (height + this.verticalStep);\n            })\n        }\n    }\n\n\n}"]}